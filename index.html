import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import datetime
import json
import os
import io
import base64
from jinja2 import Template

# --------------------------
# --- DATA PROCESSING ---
# --------------------------

def process_crispy_chicken_data():
    """Process Crispy Chicken UAE branch performance data"""
    data = {
        'summary': {
            'aov_2024': 45.32,
            'aov_2025': 44.91,
            'orders_2024': 93754,
            'orders_2025': 85093,
            'sales_2024': 4248984,
            'sales_2025': 3821344,
            'aov_change': -0.91,
            'orders_change': -9.24,
            'sales_change': -10.06
        },
        'branches': {
            'Hamdan': {
                'location': 'Abu Dhabi',
                'aov_2024': 46.19,
                'aov_2025': 45.13,
                'orders_2024': 32829,
                'orders_2025': 28267,
                'sales_2024': 1516317,
                'sales_2025': 1275676,
                'aov_change': -2.29,
                'orders_change': -13.9,
                'sales_change': -15.87,
                'online_aov_2024': 48.29,
                'online_aov_2025': 45.13,
                'online_orders_change': 5.76,
                'online_sales_change': -1.19,
                'direct_aov_2024': 45.67,
                'direct_aov_2025': 45.13,
                'direct_orders_change': -18.72,
                'direct_sales_change': -19.67
            },
            'Khalidiyah': {
                'location': 'Abu Dhabi',
                'aov_2024': 50.55,
                'aov_2025': 49.34,
                'orders_2024': 15614,
                'orders_2025': 12806,
                'sales_2024': 789296,
                'sales_2025': 631847,
                'aov_change': -2.39,
                'orders_change': -17.98,
                'sales_change': -19.95,
                'online_aov_2024': 51.71,
                'online_aov_2025': 49.0,
                'online_orders_change': -11.42,
                'online_sales_change': -16.05,
                'direct_aov_2024': 50.23,
                'direct_aov_2025': 49.45,
                'direct_orders_change': -19.84,
                'direct_sales_change': -21.13
            },
            'Shabiya': {
                'location': 'Abu Dhabi',
                'aov_2024': 44.95,
                'aov_2025': 44.71,
                'orders_2024': 13599,
                'orders_2025': 12531,
                'sales_2024': 611338,
                'sales_2025': 560295.6,
                'aov_change': -0.54,
                'orders_change': -7.85,
                'sales_change': -8.35,
                'online_aov_2024': 47.81,
                'online_aov_2025': 35.66,
                'online_orders_change': 12.92,
                'online_sales_change': -15.77,
                'direct_aov_2024': 44.49,
                'direct_aov_2025': 46.57,
                'direct_orders_change': -11.25,
                'direct_sales_change': -7.0
            },
            'Muroor': {
                'location': 'Abu Dhabi',
                'aov_2024': 49.66,
                'aov_2025': 49.81,
                'orders_2024': 12482,
                'orders_2025': 10588,
                'sales_2024': 619893,
                'sales_2025': 527386.8,
                'aov_change': 0.3,
                'orders_change': -15.17,
                'sales_change': -14.92,
                'online_aov_2024': 54.9,
                'online_aov_2025': 60.15,
                'online_orders_change': -36.69,
                'online_sales_change': -30.64,
                'direct_aov_2024': 48.96,
                'direct_aov_2025': 48.81,
                'direct_orders_change': -12.25,
                'direct_sales_change': -12.53
            },
            'Electra': {
                'location': 'Abu Dhabi',
                'aov_2024': 0,
                'aov_2025': 0,
                'orders_2024': 0,
                'orders_2025': 0,
                'sales_2024': 0,
                'sales_2025': 0,
                'aov_change': 0,
                'orders_change': 0,
                'sales_change': 0,
                'status': 'Inactive'
            },
            'Al Barsha': {
                'location': 'Dubai',
                'aov_2024': 36.9,
                'aov_2025': 39.96,
                'orders_2024': 14559,
                'orders_2025': 12504,
                'sales_2024': 537266,
                'sales_2025': 499683.7,
                'aov_change': 8.29,
                'orders_change': -14.11,
                'sales_change': -7.0,
                'online_aov_2024': 56.19,
                'online_aov_2025': 50.4,
                'online_orders_change': -40.88,
                'online_sales_change': -46.96,
                'direct_aov_2024': 33.0,
                'direct_aov_2025': 38.59,
                'direct_orders_change': -8.72,
                'direct_sales_change': 6.79
            },
            'Al Satwa': {
                'location': 'Dubai',
                'aov_2024': 37.44,
                'aov_2025': 38.85,
                'orders_2024': 4671,
                'orders_2025': 8352,
                'sales_2024': 174874,
                'sales_2025': 324462,
                'aov_change': 3.77,
                'orders_change': 78.81,
                'sales_change': 85.54,
                'online_aov_2024': 41.7,
                'online_aov_2025': 39.33,
                'online_orders_change': 221.45,
                'online_sales_change': 202.96,
                'direct_aov_2024': 36.46,
                'direct_aov_2025': 38.61,
                'direct_orders_change': 46.07,
                'direct_sales_change': 54.68
            },
            'Al Rigga': {
                'location': 'Dubai',
                'aov_2024': 0,
                'aov_2025': 44.29,
                'orders_2024': 0,
                'orders_2025': 45,
                'sales_2024': 0,
                'sales_2025': 1993,
                'aov_change': 0,
                'orders_change': 0,
                'sales_change': 0,
                'status': 'New Branch (Sep 2025)'
            }
        },
        'market_context': {
            'qsr_cagr': 19.2,
            'qsr_market_2033': 25.36,  # in billion USD
            'foodservice_cagr': 11.45,
            'foodservice_market_2033': 41.8,  # in billion USD
            'poultry_growth_2025': 6,
            'poultry_consumption_2025': 470000,  # in MT
            'online_delivery_2025': 5,  # in billion AED
            'hospitality_growth': 13.25,
            'hospitality_market_2033': 158.22  # in billion USD
        }
    }
    
    # Calculate additional metrics
    data['channels'] = {
        'online': {
            'avg_aov_2024': np.mean([b['online_aov_2024'] for b in data['branches'].values() if b['online_aov_2024'] > 0]),
            'avg_aov_2025': np.mean([b['online_aov_2025'] for b in data['branches'].values() if b['online_aov_2025'] > 0]),
            'avg_change': np.mean([(b['online_aov_2025'] - b['online_aov_2024']) / b['online_aov_2024'] * 100 
                                  for b in data['branches'].values() 
                                  if b['online_aov_2024'] > 0 and b['online_aov_2025'] > 0])
        },
        'direct': {
            'avg_aov_2024': np.mean([b['direct_aov_2024'] for b in data['branches'].values() if b['direct_aov_2024'] > 0]),
            'avg_aov_2025': np.mean([b['direct_aov_2025'] for b in data['branches'].values() if b['direct_aov_2025'] > 0]),
            'avg_change': np.mean([(b['direct_aov_2025'] - b['direct_aov_2024']) / b['direct_aov_2024'] * 100 
                                  for b in data['branches'].values() 
                                  if b['direct_aov_2024'] > 0 and b['direct_aov_2025'] > 0])
        }
    }
    
    # Calculate branch rankings
    branches_with_data = {k: v for k, v in data['branches'].items() if v['status'] != 'Inactive' and v['aov_2024'] > 0}
    data['rankings'] = {
        'aov_growth': sorted(branches_with_data.items(), 
                            key=lambda x: x[1]['aov_change'], 
                            reverse=True),
        'order_growth': sorted(branches_with_data.items(), 
                              key=lambda x: x[1]['orders_change'], 
                              reverse=True),
        'sales_growth': sorted(branches_with_data.items(), 
                              key=lambda x: x[1]['sales_change'], 
                              reverse=True)
    }
    
    return data

def create_charts(data):
    """Create charts for dashboard"""
    charts = {}
    
    # Summary Performance Chart
    fig, ax = plt.subplots(figsize=(10, 6))
    categories = ['AOV (AED)', 'Orders (×1000)', 'Sales (×1000 AED)']
    values_2024 = [data['summary']['aov_2024'], data['summary']['orders_2024']/1000, data['summary']['sales_2024']/1000]
    values_2025 = [data['summary']['aov_2025'], data['summary']['orders_2025']/1000, data['summary']['sales_2025']/1000]
    
    x = np.arange(len(categories))
    width = 0.35
    
    ax.bar(x - width/2, values_2024, width, label='2024', color='#1a73e8')
    ax.bar(x + width/2, values_2025, width, label='2025', color='#ea4335')
    
    ax.set_ylabel('Value')
    ax.set_title('Overall Performance Summary (Jan-Sep)')
    ax.set_xticks(x)
    ax.set_xticklabels(categories)
    ax.legend()
    
    buf = io.BytesIO()
    plt.savefig(buf, format='png')
    buf.seek(0)
    charts['summary_performance'] = base64.b64encode(buf.read()).decode('utf-8')
    plt.close()
    
    # Branch AOV Comparison
    fig, ax = plt.subplots(figsize=(12, 6))
    branches = list(data['branches'].keys())
    aov_changes = [data['branches'][b]['aov_change'] for b in branches]
    
    colors = ['#34a853' if x > 0 else '#ea4335' for x in aov_changes]
    bars = ax.bar(branches, aov_changes, color=colors)
    
    ax.set_ylabel('AOV Change (%)')
    ax.set_title('Branch AOV Change (2024 vs 2025)')
    ax.axhline(0, color='black', linewidth=0.8)
    
    # Add data labels
    for bar in bars:
        height = bar.get_height()
        ax.text(bar.get_x() + bar.get_width()/2., height,
                f'{height:.1f}%',
                ha='center', va='bottom' if height > 0 else 'top')
    
    plt.xticks(rotation=45)
    plt.tight_layout()
    
    buf = io.BytesIO()
    plt.savefig(buf, format='png')
    buf.seek(0)
    charts['branch_aov'] = base64.b64encode(buf.read()).decode('utf-8')
    plt.close()
    
    # Channel Performance
    fig, ax = plt.subplots(figsize=(10, 6))
    channel_labels = ['Online', 'Direct/Call']
    channel_aov_2024 = [data['channels']['online']['avg_aov_2024'], data['channels']['direct']['avg_aov_2024']]
    channel_aov_2025 = [data['channels']['online']['avg_aov_2025'], data['channels']['direct']['avg_aov_2025']]
    
    x = np.arange(len(channel_labels))
    width = 0.35
    
    ax.bar(x - width/2, channel_aov_2024, width, label='2024', color='#1a73e8')
    ax.bar(x + width/2, channel_aov_2025, width, label='2025', color='#34a853')
    
    ax.set_ylabel('Average AOV (AED)')
    ax.set_title('Channel AOV Comparison')
    ax.set_xticks(x)
    ax.set_xticklabels(channel_labels)
    ax.legend()
    
    buf = io.BytesIO()
    plt.savefig(buf, format='png')
    buf.seek(0)
    charts['channel_performance'] = base64.b64encode(buf.read()).decode('utf-8')
    plt.close()
    
    # Regional Comparison
    fig, ax = plt.subplots(figsize=(10, 6))
    abu_dhabi_branches = [b for b in data['branches'].keys() if data['branches'][b]['location'] == 'Abu Dhabi' and data['branches'][b]['status'] != 'Inactive']
    dubai_branches = [b for b in data['branches'].keys() if data['branches'][b]['location'] == 'Dubai']
    
    abu_d_avg_aov = np.mean([data['branches'][b]['aov_change'] for b in abu_dhabi_branches])
    dubai_avg_aov = np.mean([data['branches'][b]['aov_change'] for b in dubai_branches])
    
    regions = ['Abu Dhabi', 'Dubai']
    avg_changes = [abu_d_avg_aov, dubai_avg_aov]
    
    bars = ax.bar(regions, avg_changes, color=[ '#ea4335' if x < 0 else '#34a853' for x in avg_changes])
    
    ax.set_ylabel('Average AOV Change (%)')
    ax.set_title('Regional AOV Performance Comparison')
    ax.axhline(0, color='black', linewidth=0.8)
    
    # Add data labels
    for bar in bars:
        height = bar.get_height()
        ax.text(bar.get_x() + bar.get_width()/2., height,
                f'{height:.1f}%',
                ha='center', va='bottom' if height > 0 else 'top')
    
    buf = io.BytesIO()
    plt.savefig(buf, format='png')
    buf.seek(0)
    charts['regional_comparison'] = base64.b64encode(buf.read()).decode('utf-8')
    plt.close()
    
    return charts

# --------------------------
# --- DASHBOARD GENERATION ---
# --------------------------

def generate_dashboard(output_file="crispy_chicken_dashboard.html"):
    """Generate the complete dashboard"""
    # Process data
    data = process_crispy_chicken_data()
    charts = create_charts(data)
    
    # Create dashboard HTML
    html_content = f"""
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crispy Chicken UAE Performance Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.5.31/dist/jspdf.plugin.autotable.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {{
            --primary-color: #1a73e8;
            --secondary-color: #34a853;
            --accent-color: #ea4335;
            --warning-color: #fbbc05;
            --dark-color: #202124;
            --light-color: #f8f9fa;
            --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --hover-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }}
        
        * {{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }}
        
        body {{
            font-family: 'Poppins', sans-serif;
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }}
        
        .container {{
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }}
        
        header {{
            background: linear-gradient(135deg, var(--primary-color), #0d47a1);
            color: white;
            padding: 30px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }}
        
        header::before {{
            content: "";
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: rotate(30deg);
        }}
        
        header h1 {{
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            gap: 15px;
        }}
        
        .subtitle {{
            font-size: 1.2rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }}
        
        .period-selector {{
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
        }}
        
        .period-info {{
            text-align: center;
            padding: 0 30px;
        }}
        
        .period-info h3 {{
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }}
        
        .period-info p {{
            font-size: 1.1rem;
            color: #5f6368;
        }}
        
        .period-divider {{
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0 20px;
        }}
        
        .period-divider i {{
            font-size: 2rem;
            color: var(--warning-color);
        }}
        
        .dashboard {{
            display: flex;
            gap: 25px;
        }}
        
        .sidebar {{
            width: 280px;
            background: white;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            padding: 25px;
            height: fit-content;
            position: sticky;
            top: 20px;
        }}
        
        .sidebar h2 {{
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }}
        
        .menu-item {{
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }}
        
        .menu-item:hover {{
            background: #f1f3f4;
        }}
        
        .menu-item.active {{
            background: var(--primary-color);
            color: white;
        }}
        
        .content {{
            flex: 1;
            background: white;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            padding: 30px;
        }}
        
        .section {{
            display: none;
        }}
        
        .section.active {{
            display: block;
            animation: fadeIn 0.5s ease;
        }}
        
        @keyframes fadeIn {{
            from {{ opacity: 0; transform: translateY(10px); }}
            to {{ opacity: 1; transform: translateY(0); }}
        }}
        
        .section h2 {{
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }}
        
        .stats-grid {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }}
        
        .stat-card {{
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            border-top: 4px solid var(--primary-color);
        }}
        
        .stat-card:hover {{
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
        }}
        
        .stat-card.negative {{
            border-top-color: var(--accent-color);
        }}
        
        .stat-card.positive {{
            border-top-color: var(--secondary-color);
        }}
        
        .stat-card h3 {{
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--dark-color);
        }}
        
        .stat-value {{
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 15px;
        }}
        
        .stat-value.negative {{
            color: var(--accent-color);
        }}
        
        .stat-value.positive {{
            color: var(--secondary-color);
        }}
        
        .stat-detail {{
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }}
        
        .stat-label {{
            color: #5f6368;
        }}
        
        .stat-amount {{
            font-weight: 600;
        }}
        
        .alert {{
            padding: 18px 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }}
        
        .alert-success {{
            background: rgba(52, 168, 83, 0.1);
            border-left: 4px solid var(--secondary-color);
        }}
        
        .alert-success h3 {{
            color: var(--secondary-color);
            margin-bottom: 5px;
        }}
        
        .alert-success p {{
            color: #3c4043;
        }}
        
        .alert-danger {{
            background: rgba(234, 67, 53, 0.1);
            border-left: 4px solid var(--accent-color);
        }}
        
        .alert-danger h3 {{
            color: var(--accent-color);
            margin-bottom: 5px;
        }}
        
        .alert-danger p {{
            color: #3c4043;
        }}
        
        .alert-warning {{
            background: rgba(251, 188, 5, 0.1);
            border-left: 4px solid var(--warning-color);
        }}
        
        .alert-warning h3 {{
            color: var(--warning-color);
            margin-bottom: 5px;
        }}
        
        .alert-warning p {{
            color: #3c4043;
        }}
        
        .comparison-table {{
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }}
        
        .comparison-table th, .comparison-table td {{
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }}
        
        .comparison-table th {{
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }}
        
        .comparison-table tr:last-child td {{
            border-bottom: none;
        }}
        
        .comparison-table tr:nth-child(even) {{
            background: #f8f9fa;
        }}
        
        .comparison-table .negative {{
            color: var(--accent-color);
            font-weight: 600;
        }}
        
        .comparison-table .positive {{
            color: var(--secondary-color);
            font-weight: 600;
        }}
        
        .strategy-card {{
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            margin-bottom: 25px;
            border-left: 4px solid var(--primary-color);
        }}
        
        .strategy-card h3 {{
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }}
        
        .strategy-card .outlet-tag {{
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary-color);
            margin-right: 8px;
        }}
        
        .strategy-card ul {{
            padding-left: 20px;
            margin-top: 15px;
        }}
        
        .strategy-card li {{
            margin-bottom: 8px;
            line-height: 1.6;
        }}
        
        .chart-container {{
            margin: 30px 0;
            position: relative;
            height: 400px;
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--card-shadow);
        }}
        
        .chart-container h3 {{
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--dark-color);
        }}
        
        .tabs {{
            display: flex;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 25px;
        }}
        
        .tab {{
            padding: 12px 20px;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
        }}
        
        .tab:hover {{
            background: #f8f9fa;
        }}
        
        .tab.active {{
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }}
        
        .tab-content {{
            display: none;
        }}
        
        .tab-content.active {{
            display: block;
        }}
        
        .btn {{
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }}
        
        .btn-primary {{
            background: var(--primary-color);
            color: white;
        }}
        
        .btn-primary:hover {{
            background: #0d47a1;
        }}
        
        .btn-secondary {{
            background: var(--secondary-color);
            color: white;
        }}
        
        .btn-secondary:hover {{
            background: #0f9d58;
        }}
        
        .btn-danger {{
            background: var(--accent-color);
            color: white;
        }}
        
        .btn-danger:hover {{
            background: #c62828;
        }}
        
        .btn-warning {{
            background: var(--warning-color);
            color: #333;
        }}
        
        .btn-warning:hover {{
            background: #f9a825;
        }}
        
        .btn-group {{
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }}
        
        .chart-image {{
            max-width: 100%;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
        }}
        
        .badge {{
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }}
        
        .badge-success {{
            background: rgba(52, 168, 83, 0.1);
            color: var(--secondary-color);
        }}
        
        .badge-danger {{
            background: rgba(234, 67, 53, 0.1);
            color: var(--accent-color);
        }}
        
        .badge-warning {{
            background: rgba(251, 188, 5, 0.1);
            color: var(--warning-color);
        }}
        
        .market-insights {{
            background: linear-gradient(135deg, rgba(26, 115, 232, 0.05), rgba(52, 168, 83, 0.05));
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
            border-left: 4px solid var(--primary-color);
        }}
        
        .market-insights h3 {{
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }}
        
        .market-insights ul {{
            padding-left: 20px;
            margin-top: 15px;
        }}
        
        .market-insights li {{
            margin-bottom: 10px;
            line-height: 1.6;
        }}
        
        @media (max-width: 1200px) {{
            .dashboard {{
                flex-direction: column;
            }}
            .sidebar {{
                width: 100%;
                position: static;
            }}
        }}
        
        @media (max-width: 768px) {{
            .stats-grid {{
                grid-template-columns: 1fr;
            }}
            .btn-group {{
                flex-direction: column;
            }}
            .period-selector {{
                flex-direction: column;
            }}
            .period-divider {{
                flex-direction: row;
                padding: 20px 0;
            }}
        }}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-chart-line"></i> Crispy Chicken UAE Performance Dashboard</h1>
            <div class="subtitle">Jan-Sep 2024 vs. Jan-Sep 2025 Analysis for UAE Branches</div>
        </header>

        <div class="period-selector">
            <div class="period-info">
                <h3>Jan-Sep 2024</h3>
                <p>Baseline Period</p>
            </div>
            <div class="period-divider">
                <i class="fas fa-exchange-alt"></i>
            </div>
            <div class="period-info">
                <h3>Jan-Sep 2025</h3>
                <p>Comparison Period</p>
            </div>
        </div>

        <div class="dashboard">
            <aside class="sidebar">
                <h2><i class="fas fa-bars"></i> Navigation</h2>
                <div class="menu-item active" data-section="executive-summary">
                    <i class="fas fa-chart-pie"></i> <span>Executive Summary</span>
                </div>
                <div class="menu-item" data-section="branch-performance">
                    <i class="fas fa-store"></i> <span>Branch Performance</span>
                </div>
                <div class="menu-item" data-section="channel-analysis">
                    <i class="fas fa-exchange-alt"></i> <span>Channel Analysis</span>
                </div>
                <div class="menu-item" data-section="regional-comparison">
                    <i class="fas fa-map-marked-alt"></i> <span>Regional Comparison</span>
                </div>
                <div class="menu-item" data-section="market-insights">
                    <i class="fas fa-lightbulb"></i> <span>Market Insights</span>
                </div>
                <div class="menu-item" data-section="strategic-recommendations">
                    <i class="fas fa-tasks"></i> <span>Strategic Recommendations</span>
                </div>
            </aside>

            <main class="content">
                <!-- Executive Summary Section -->
                <section id="executive-summary" class="section active">
                    <h2><i class="fas fa-chart-pie"></i> Executive Summary</h2>
                    
                    <div class="alert alert-danger">
                        <h3><i class="fas fa-exclamation-triangle"></i> Performance Decline</h3>
                        <p>Crispy Chicken UAE experienced a modest decline in performance from 2024 to 2025, with AOV down -0.91%, orders down -9.24%, and sales down -10.06%. However, Dubai branches outperformed Abu Dhabi locations.</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card negative">
                            <h3><i class="fas fa-arrow-down"></i> Overall AOV</h3>
                            <div class="stat-value negative">{data['summary']['aov_change']:.2f}%</div>
                            <div class="stat-detail">
                                <span class="stat-label">2024 AOV:</span>
                                <span class="stat-amount">{data['summary']['aov_2024']:.2f} AED</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">2025 AOV:</span>
                                <span class="stat-amount">{data['summary']['aov_2025']:.2f} AED</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Key Driver:</span>
                                <span class="stat-amount">Discounting & competition</span>
                            </div>
                        </div>
                        
                        <div class="stat-card negative">
                            <h3><i class="fas fa-shopping-cart"></i> Order Volume</h3>
                            <div class="stat-value negative">{data['summary']['orders_change']:.2f}%</div>
                            <div class="stat-detail">
                                <span class="stat-label">2024 Orders:</span>
                                <span class="stat-amount">{data['summary']['orders_2024']:,}</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">2025 Orders:</span>
                                <span class="stat-amount">{data['summary']['orders_2025']:,}</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Impact:</span>
                                <span class="stat-amount">Economic pressures</span>
                            </div>
                        </div>
                        
                        <div class="stat-card negative">
                            <h3><i class="fas fa-money-bill-wave"></i> Total Sales</h3>
                            <div class="stat-value negative">{data['summary']['sales_change']:.2f}%</div>
                            <div class="stat-detail">
                                <span class="stat-label">2024 Sales:</span>
                                <span class="stat-amount">{data['summary']['sales_2024']:,} AED</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">2025 Sales:</span>
                                <span class="stat-amount">{data['summary']['sales_2025']:,} AED</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Revenue Loss:</span>
                                <span class="stat-amount">{data['summary']['sales_2024'] - data['summary']['sales_2025']:,} AED</span>
                            </div>
                        </div>
                        
                        <div class="stat-card positive">
                            <h3><i class="fas fa-star"></i> Best Performer</h3>
                            <div class="stat-value positive">Al Satwa</div>
                            <div class="stat-detail">
                                <span class="stat-label">AOV Growth:</span>
                                <span class="stat-amount">{data['branches']['Al Satwa']['aov_change']:.2f}%</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Order Growth:</span>
                                <span class="stat-amount">{data['branches']['Al Satwa']['orders_change']:.2f}%</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Sales Growth:</span>
                                <span class="stat-amount">{data['branches']['Al Satwa']['sales_change']:.2f}%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3><i class="fas fa-chart-bar"></i> Overall Performance Summary</h3>
                        <img src="data:image/png;base64,{charts['summary_performance']}" alt="Overall Performance Summary" class="chart-image">
                    </div>
                </section>

                <!-- Branch Performance Section -->
                <section id="branch-performance" class="section">
                    <h2><i class="fas fa-store"></i> Branch Performance Analysis</h2>
                    
                    <div class="chart-container">
                        <h3><i class="fas fa-chart-bar"></i> Branch AOV Change (2024 vs 2025)</h3>
                        <img src="data:image/png;base64,{charts['branch_aov']}" alt="Branch AOV Change" class="chart-image">
                    </div>
                    
                    <h3>Branch Performance Metrics</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Branch</th>
                                <th>Location</th>
                                <th>AOV Change (%)</th>
                                <th>Orders Change (%)</th>
                                <th>Sales Change (%)</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Al Satwa</strong></td>
                                <td>Dubai</td>
                                <td class="positive">{data['branches']['Al Satwa']['aov_change']:.2f}%</td>
                                <td class="positive">{data['branches']['Al Satwa']['orders_change']:.2f}%</td>
                                <td class="positive">{data['branches']['Al Satwa']['sales_change']:.2f}%</td>
                                <td><span class="badge badge-success">Strong Growth</span></td>
                            </tr>
                            <tr>
                                <td><strong>Al Barsha</strong></td>
                                <td>Dubai</td>
                                <td class="positive">{data['branches']['Al Barsha']['aov_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Al Barsha']['orders_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Al Barsha']['sales_change']:.2f}%</td>
                                <td><span class="badge badge-warning">AOV Growth</span></td>
                            </tr>
                            <tr>
                                <td><strong>Muroor</strong></td>
                                <td>Abu Dhabi</td>
                                <td class="positive">{data['branches']['Muroor']['aov_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Muroor']['orders_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Muroor']['sales_change']:.2f}%</td>
                                <td><span class="badge badge-success">AOV Growth</span></td>
                            </tr>
                            <tr>
                                <td><strong>Shabiya</strong></td>
                                <td>Abu Dhabi</td>
                                <td class="negative">{data['branches']['Shabiya']['aov_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Shabiya']['orders_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Shabiya']['sales_change']:.2f}%</td>
                                <td><span class="badge badge-warning">Online Collapse</span></td>
                            </tr>
                            <tr>
                                <td><strong>Hamdan</strong></td>
                                <td>Abu Dhabi</td>
                                <td class="negative">{data['branches']['Hamdan']['aov_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Hamdan']['orders_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Hamdan']['sales_change']:.2f}%</td>
                                <td><span class="badge badge-danger">Declining</span></td>
                            </tr>
                            <tr>
                                <td><strong>Khalidiyah</strong></td>
                                <td>Abu Dhabi</td>
                                <td class="negative">{data['branches']['Khalidiyah']['aov_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Khalidiyah']['orders_change']:.2f}%</td>
                                <td class="negative">{data['branches']['Khalidiyah']['sales_change']:.2f}%</td>
                                <td><span class="badge badge-danger">Declining</span></td>
                            </tr>
                            <tr>
                                <td><strong>Electra</strong></td>
                                <td>Abu Dhabi</td>
                                <td>0%</td>
                                <td>0%</td>
                                <td>0%</td>
                                <td><span class="badge badge-warning">Inactive</span></td>
                            </tr>
                            <tr>
                                <td><strong>Al Rigga</strong></td>
                                <td>Dubai</td>
                                <td>New Branch</td>
                                <td>New Branch</td>
                                <td>New Branch</td>
                                <td><span class="badge badge-success">New Launch</span></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="top-performers">Top Performers</div>
                        <div class="tab" data-tab="challenges">Challenges</div>
                        <div class="tab" data-tab="opportunities">Opportunities</div>
                    </div>
                    
                    <div id="top-performers" class="tab-content active">
                        <h3>Top Performing Branches</h3>
                        <div class="strategy-card">
                            <h3><i class="fas fa-star"></i> Al Satwa (Dubai)</h3>
                            <ul>
                                <li><strong>Strong Growth Driver:</strong> 78.81% order increase and 85.54% sales growth</li>
                                <li><strong>Success Factors:</strong> New branch with strong marketing and promotions</li>
                                <li><strong>Online Performance:</strong> Online orders surged 221.45% despite AOV decline</li>
                                <li><strong>Recommendation:</strong> Replicate Al Satwa's growth strategy in other Dubai locations</li>
                            </ul>
                        </div>
                        
                        <div class="strategy-card">
                            <h3><i class="fas fa-star"></i> Al Barsha (Dubai)</h3>
                            <ul>
                                <li><strong>AOV Growth:</strong> 8.29% increase in average order value</li>
                                <li><strong>Direct Channel:</strong> Strong performance in direct/call channel (+6.79% sales)</li>
                                <li><strong>Tourism Impact:</strong> Benefits from Dubai's tourism boom</li>
                                <li><strong>Recommendation:</strong> Enhance direct channel experience and leverage tourism</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div id="challenges" class="tab-content">
                        <h3>Key Challenges</h3>
                        <div class="strategy-card">
                            <h3><i class="fas fa-exclamation-circle"></i> Abu Dhabi Decline</h3>
                            <ul>
                                <li><strong>Overall Trend:</strong> All Abu Dhabi branches except Muroor show declining AOV</li>
                                <li><strong>Service Issues:</strong> Customer reviews highlight rude staff and delivery delays</li>
                                <li><strong>Competition:</strong> Premium outlets attracting high-value customers</li>
                                <li><strong>Online Collapse:</strong> Shabiya's online AOV plunged -25.42%</li>
                            </ul>
                        </div>
                        
                        <div class="strategy-card">
                            <h3><i class="fas fa-exclamation-circle"></i> Order Volume Decline</h3>
                            <ul>
                                <li><strong>Chain-wide:</strong> 9.24% decrease in order volume</li>
                                <li><strong>Abu Dhabi:</strong> Average order decline of 13.6%</li>
                                <li><strong>Impact:</strong> Lower volumes offsetting slight AOV changes</li>
                                <li><strong>Root Cause:</strong> Economic pressures and competition</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div id="opportunities" class="tab-content">
                        <h3>Growth Opportunities</h3>
                        <div class="strategy-card">
                            <h3><i class="fas fa-lightbulb"></i> Dubai Expansion</h3>
                            <ul>
                                <li><strong>Tourism Boom:</strong> Dubai's hospitality growing at 13.25% annually</li>
                                <li><strong>Success Model:</strong> Al Satwa and Al Barsha demonstrate Dubai potential</li>
                                <li><strong>New Branches:</strong> Al Rigga shows promise with promotions</li>
                                <li><strong>Strategy:</strong> Focus on high-traffic tourist areas</li>
                            </ul>
                        </div>
                        
                        <div class="strategy-card">
                            <h3><i class="fas fa-lightbulb"></i> Premium Positioning</h3>
                            <ul>
                                <li><strong>Muroor Success:</strong> Online AOV up 9.58% with premium focus</li>
                                <li><strong>Poultry Growth:</strong> UAE poultry consumption rising 6% in 2025</li>
                                <li><strong>Market Size:</strong> Foodservice market to reach $41.8B by 2033</li>
                                <li><strong>Strategy:</strong> Develop premium menu items and loyalty programs</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Channel Analysis Section -->
                <section id="channel-analysis" class="section">
                    <h2><i class="fas fa-exchange-alt"></i> Channel Performance Analysis</h2>
                    
                    <div class="chart-container">
                        <h3><i class="fas fa-chart-bar"></i> Channel AOV Comparison</h3>
                        <img src="data:image/png;base64,{charts['channel_performance']}" alt="Channel AOV Comparison" class="chart-image">
                    </div>
                    
                    <h3>Channel Performance Breakdown</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Channel</th>
                                <th>2024 Avg AOV (AED)</th>
                                <th>2025 Avg AOV (AED)</th>
                                <th>Change (%)</th>
                                <th>Performance</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Online</strong></td>
                                <td>{data['channels']['online']['avg_aov_2024']:.2f}</td>
                                <td>{data['channels']['online']['avg_aov_2025']:.2f}</td>
                                <td class="negative">{data['channels']['online']['avg_change']:.2f}%</td>
                                <td><span class="badge badge-danger">Declining</span></td>
                            </tr>
                            <tr>
                                <td><strong>Direct/Call</strong></td>
                                <td>{data['channels']['direct']['avg_aov_2024']:.2f}</td>
                                <td>{data['channels']['direct']['avg_aov_2025']:.2f}</td>
                                <td class="positive">{data['channels']['direct']['avg_change']:.2f}%</td>
                                <td><span class="badge badge-success">Stable</span></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h3>Branch Channel Performance</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Branch</th>
                                <th>Online AOV Change</th>
                                <th>Direct AOV Change</th>
                                <th>Channel Strategy</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Shabiya</strong></td>
                                <td class="negative">-25.42%</td>
                                <td class="positive">+4.67%</td>
                                <td>Restructure online discounts, focus on direct channel</td>
                            </tr>
                            <tr>
                                <td><strong>Muroor</strong></td>
                                <td class="positive">+9.58%</td>
                                <td class="negative">-0.31%</td>
                                <td>Leverage premium online positioning, maintain direct quality</td>
                            </tr>
                            <tr>
                                <td><strong>Al Barsha</strong></td>
                                <td class="negative">-10.30%</td>
                                <td class="positive">+16.95%</td>
                                <td>Enhance direct experience, restructure online offerings</td>
                            </tr>
                            <tr>
                                <td><strong>Al Satwa</strong></td>
                                <td class="negative">-5.68%</td>
                                <td class="positive">+5.91%</td>
                                <td>Focus on direct channel growth, maintain online volume</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="strategy-card">
                        <h3><i class="fas fa-chart-line"></i> Channel Strategy Insights</h3>
                        <ul>
                            <li><strong>Online Channel:</strong> Showing decline across most branches except Muroor, indicating need for discount restructuring</li>
                            <li><strong>Direct/Call Channel:</strong> More stable performance with growth in several branches, suggesting better customer experience</li>
                            <li><strong>Opportunity:</strong> UAE online delivery market projected to exceed AED 5 billion in 2025</li>
                            <li><strong>Recommendation:</strong> Balance both channels with premium positioning online and enhanced direct service</li>
                        </ul>
                    </div>
                </section>

                <!-- Regional Comparison Section -->
                <section id="regional-comparison" class="section">
                    <h2><i class="fas fa-map-marked-alt"></i> Regional Performance Comparison</h2>
                    
                    <div class="chart-container">
                        <h3><i class="fas fa-chart-bar"></i> Regional AOV Performance</h3>
                        <img src="data:image/png;base64,{charts['regional_comparison']}" alt="Regional Comparison" class="chart-image">
                    </div>
                    
                    <h3>Regional Breakdown</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3><i class="fas fa-building"></i> Abu Dhabi</h3>
                            <div class="stat-value negative">-1.48%</div>
                            <div class="stat-detail">
                                <span class="stat-label">Branches:</span>
                                <span class="stat-amount">4 Active</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Performance:</span>
                                <span class="stat-amount">Mixed with Muroor positive</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Challenge:</span>
                                <span class="stat-amount">Service issues</span>
                            </div>
                        </div>
                        
                        <div class="stat-card positive">
                            <h3><i class="fas fa-city"></i> Dubai</h3>
                            <div class="stat-value positive">+5.42%</div>
                            <div class="stat-detail">
                                <span class="stat-label">Branches:</span>
                                <span class="stat-amount">3 Active</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Performance:</span>
                                <span class="stat-amount">Strong growth</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Driver:</span>
                                <span class="stat-amount">Tourism boom</span>
                            </div>
                        </div>
                    </div>
                    
                    <h3>Regional Market Context</h3>
                    <div class="market-insights">
                        <h3><i class="fas fa-globe"></i> UAE Market Dynamics</h3>
                        <ul>
                            <li><strong>Tourism Impact:</strong> Dubai's hospitality sector growing at 13.25% annually, reaching $158.22B by 2033</li>
                            <li><strong>Population Growth:</strong> Urbanization driving demand for QSR services</li>
                            <li><strong>Food Delivery:</strong> Online food delivery market projected to exceed AED 5B in 2025</li>
                            <li><strong>Poultry Demand:</strong> Poultry consumption expected to rise 6% in 2025 to 470,000 MT</li>
                            <li><strong>QSR Growth:</strong> Quick-service restaurant market growing at 19.2% CAGR to $25.36B by 2033</li>
                        </ul>
                    </div>
                    
                    <h3>Regional Strategy Recommendations</h3>
                    <div class="strategy-card">
                        <h3><i class="fas fa-map-pin"></i> Abu Dhabi Strategy</h3>
                        <ul>
                            <li><strong>Service Improvement:</strong> Address customer complaints about rudeness and delivery delays</li>
                            <li><strong>Premium Positioning:</strong> Follow Muroor's premium strategy with high-value menu items</li>
                            <li><strong>Online Restructuring:</strong> Address Shabiya's online collapse with discount reforms</li>
                            <li><strong>Competitive Differentiation:</strong> Focus on quality and service to compete with premium outlets</li>
                        </ul>
                    </div>
                    
                    <div class="strategy-card">
                        <h3><i class="fas fa-rocket"></i> Dubai Strategy</h3>
                        <ul>
                            <li><strong>Tourist Focus:</strong> Leverage Dubai's tourism boom with targeted promotions</li>
                            <li><strong>Replicate Success:</strong> Expand Al Satwa's growth model to other locations</li>
                            <li><strong>High-Traffic Areas:</strong> Focus on areas with high tourist and local foot traffic</li>
                            <li><strong>Online Optimization:</strong> Enhance online experience to capture growing delivery market</li>
                        </ul>
                    </div>
                </section>

                <!-- Market Insights Section -->
                <section id="market-insights" class="section">
                    <h2><i class="fas fa-lightbulb"></i> Market Insights & Trends</h2>
                    
                    <div class="market-insights">
                        <h3><i class="fas fa-chart-line"></i> UAE QSR Market Outlook</h3>
                        <ul>
                            <li><strong>Market Size:</strong> UAE QSR market growing at 19.2% CAGR to reach $25.36 billion by 2033</li>
                            <li><strong>Foodservice Growth:</strong> Overall foodservice sector projected to grow at 11.45% CAGR to $41.8B by 2033</li>
                            <li><strong>Delivery Expansion:</strong> Online food delivery market expected to exceed AED 5 billion in 2025</li>
                            <li><strong>Poultry Consumption:</strong> Poultry consumption forecast to rise 6% in 2025 to 470,000 MT</li>
                            <li><strong>Tourism Impact:</strong> Hospitality sector growing at 13.25% annually, reaching $158.22B by 2033</li>
                        </ul>
                    </div>
                    
                    <h3>Competitive Landscape</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Competitor</th>
                                <th>Market Position</th>
                                <th>Strengths</th>
                                <th>Threat Level</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>KFC</strong></td>
                                <td>Global Leader</td>
                                <td>Brand recognition, global supply chain</td>
                                <td><span class="badge badge-danger">High</span></td>
                            </tr>
                            <tr>
                                <td><strong>Al Baik</strong></td>
                                <td>Local Favorite</td>
                                <td>23 UAE branches, strong local following</td>
                                <td><span class="badge badge-warning">Medium</span></td>
                            </tr>
                            <tr>
                                <td><strong>Local Cafés</strong></td>
                                <td>Niche Players</td>
                                <td>Authentic experience, community focus</td>
                                <td><span class="badge badge-success">Low</span></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h3>Customer Feedback Analysis</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3><i class="fas fa-thumbs-up"></i> Strengths</h3>
                            <div class="stat-value">4.1/5</div>
                            <div class="stat-detail">
                                <span class="stat-label">Food Quality:</span>
                                <span class="stat-amount">Consistently praised</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Portion Size:</span>
                                <span class="stat-amount">Good value perception</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Taste:</span>
                                <span class="stat-amount">Competitive advantage</span>
                            </div>
                        </div>
                        
                        <div class="stat-card negative">
                            <h3><i class="fas fa-thumbs-down"></i> Weaknesses</h3>
                            <div class="stat-value">3.2/5</div>
                            <div class="stat-detail">
                                <span class="stat-label">Service:</span>
                                <span class="stat-amount">Rude staff complaints</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Hygiene:</span>
                                <span class="stat-amount">Occasional concerns</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Delivery:</span>
                                <span class="stat-amount">Delays reported</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="strategy-card">
                        <h3><i class="fas fa-trending-up"></i> Market Opportunity Analysis</h3>
                        <ul>
                            <li><strong>Poultry Growth:</strong> 6% increase in poultry consumption creates significant opportunity for fried chicken specialists</li>
                            <li><strong>Delivery Market:</strong> Online delivery exceeding AED 5B in 2025 presents digital growth opportunity</li>
                            <li><strong>Tourism Boom:</strong> Dubai's 13.25% hospitality growth provides prime expansion environment</li>
                            <li><strong>Quality Focus:</strong> Strong food quality ratings provide competitive advantage in service-focused market</li>
                            <li><strong>Government Support:</strong> Subsidies for local poultry production improve cost structure</li>
                        </ul>
                    </div>
                </section>

                <!-- Strategic Recommendations Section -->
                <section id="strategic-recommendations" class="section">
                    <h2><i class="fas fa-tasks"></i> Strategic Recommendations</h2>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="immediate">Immediate Actions (1-2 Months)</div>
                        <div class="tab" data-tab="medium-term">Medium-Term (3-6 Months)</div>
                        <div class="tab" data-tab="long-term">Long-Term (6+ Months)</div>
                    </div>
                    
                    <div id="immediate" class="tab-content active">
                        <h3>Immediate Actions (1-2 Months)</h3>
                        
                        <div class="strategy-card">
                            <h3><i class="fas fa-exclamation-circle"></i> Service Quality Improvement</h3>
                            <ul>
                                <li><strong>Staff Training:</strong> Implement comprehensive service training program focusing on customer interactions</li>
                                <li><strong>Mystery Shopping:</strong> Conduct regular audits to identify service gaps</li>
                                <li><strong>Feedback System:</strong> Establish real-time customer feedback mechanism</li>
                                <li><strong>Incentives:</strong> Reward staff for positive customer reviews</li>
                            </ul>
                        </div>
                        
                        <div class="strategy-card">
                            <h3><i class="fas fa-tag"></i> Online Discount Restructuring</h3>
                            <ul>
                                <li><strong>Shabiya Focus:</strong> Address -25.42% online AOV decline with tiered discounts</li>
                                <li><strong>Minimum Order:</strong> Introduce AED 40 minimum for free delivery</li>
                                <li><strong>Basket Building:</strong> Force combos and eliminate single low-value items</li>
                                <li><strong>Performance Tracking:</strong> Monitor daily online AOV with alerts for declines</li>
                            </ul>
                        </div>
                        
                        <div class="strategy-card">
                            <h3><i class="fas fa-store"></i> Abu Dhabi Branch Revitalization</h3>
                            <ul>
                                <li><strong>Hamdan:</strong> Address -15.87% sales decline with direct channel improvements</li>
                                <li><strong>Khalidiyah:</strong> Counter -19.95% sales drop with premium menu reintroduction</li>
                                <li><strong>Electra:</strong> Evaluate closure or relocation strategy</li>
                                <li><strong>Regional Alignment:</strong> Standardize service protocols across Abu Dhabi branches</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div id="medium-term" class="tab-content">
                        <h3>Medium-Term Strategy (3-6 Months)</h3>
                        
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Initiative</th>
                                    <th>Implementation Details</th>
                                    <th>Expected Impact</th>
                                    <th>Timeline</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Dubai Expansion</strong></td>
                                    <td>
                                        <ul>
                                            <li>Open 2-3 new branches in high-traffic tourist areas</li>
                                            <li>Replicate Al Satwa's success model with targeted promotions</li>
                                            <li>Focus on areas with high tourist concentration</li>
                                        </ul>
                                    </td>
                                    <td><strong>+15% sales</strong> in Dubai region</td>
                                    <td>3-4 months</td>
                                </tr>
                                <tr>
                                    <td><strong>Premium Menu Launch</strong></td>
                                    <td>
                                        <ul>
                                            <li>Develop premium fried chicken line (AED 35-45 range)</li>
                                            <li>Highlight premium ingredients in marketing</li>
                                            <li>Target affluent neighborhoods and business districts</li>
                                        </ul>
                                    </td>
                                    <td><strong>+8% AOV</strong> chain-wide</td>
                                    <td>2-3 months</td>
                                </tr>
                                <tr>
                                    <td><strong>Dynamic Pricing</strong></td>
                                    <td>
                                        <ul>
                                            <li>Implement surge pricing during peak hours (7-9 PM)</li>
                                            <li>Slow-day discounts (e.g., -15% on Tuesdays)</li>
                                            <li>Weather-based pricing adjustments</li>
                                        </ul>
                                    </td>
                                    <td><strong>+12% AOV</strong> in optimized channels</td>
                                    <td>4-5 months</td>
                                </tr>
                                <tr>
                                    <td><strong>Loyalty Program</strong></td>
                                    <td>
                                        <ul>
                                            <li>Gold Tier: Free delivery on orders > AED 60</li>
                                            <li>Silver Tier: 5% discount on orders > AED 40</li>
                                            <li>Bronze Tier: Points accumulation for rewards</li>
                                        </ul>
                                    </td>
                                    <td><strong>+15% retention</strong> and <strong>+5% AOV</strong></td>
                                    <td>3-4 months</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="long-term" class="tab-content">
                        <h3>Long-Term Strategy (6+ Months)</h3>
                        
                        <div class="strategy-card">
                            <h3><i class="fas fa-robot"></i> Digital Transformation</h3>
                            <ul>
                                <li><strong>AI-Powered Upselling:</strong> Implement AI recommendations for add-ons based on order history</li>
                                <li><strong>Mobile App Enhancement:</strong> Develop app with personalized offers and loyalty features</li>
                                <li><strong>Data Analytics:</strong> Build customer analytics platform for targeted marketing</li>
                                <li><strong>Delivery Optimization:</strong> Partner with premium delivery services for faster service</li>
                            </ul>
                        </div>
                        
                        <div class="strategy-card">
                            <h3><i class="fas fa-crown"></i> Premium Brand Positioning</h3>
                            <ul>
                                <li><strong>Signature Line:</strong> Launch premium "Crispy Chicken Signature" line with premium ingredients</li>
                                <li><strong>Restaurant Experience:</strong> Upgrade flagship branches with premium dining experience</li>
                                <li><strong>Corporate Partnerships:</strong> Target corporate clients with catering and premium offerings</li>
                                <li><strong>International Expansion:</strong> Explore opportunities in neighboring Gulf countries</li>
                            </ul>
                        </div>
                        
                        <div class="strategy-card">
                            <h3><i class="fas fa-box"></i> Operational Excellence</h3>
                            <ul>
                                <li><strong>Supply Chain:</strong> Optimize supply chain with government-supported local sourcing</li>
                                <li><strong>Quality Control:</strong> Implement rigorous quality assurance protocols</li>
                                <li><strong>Sustainability:</strong> Develop eco-friendly packaging and operations</li>
                                <li><strong>Franchise Model:</strong> Prepare for franchise expansion to accelerate growth</li>
                            </ul>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script>
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Navigation functionality
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.menu-item').forEach(menu => menu.classList.remove('active'));
                    this.classList.add('active');
                    
                    const targetSection = this.dataset.section;
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(targetSection).classList.add('active');
                });
            });
            
            // Tab functionality
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabContainer = this.parentElement;
                    const tabContents = tabContainer.parentElement.querySelectorAll('.tab-content');
                    
                    // Update tab active state
                    tabContainer.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding content
                    const tabId = this.dataset.tab;
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === tabId) {
                            content.classList.add('active');
                        }
                    });
                });
            });
        });
    </script>
</body>
</html>
"""
    
    # Write the HTML file
    with open(output_file, 'w', encoding='utf-8') as f:
        f.write(html_content)
    
    print(f"Dashboard generated successfully: {output_file}")

# --------------------------
# --- MAIN EXECUTION ---
# --------------------------

if __name__ == "__main__":
    # Generate the dashboard
    generate_dashboard()
