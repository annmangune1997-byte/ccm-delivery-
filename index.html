import pandas as pd
import numpy as np
from datetime import datetime
import plotly.express as px
import plotly.io as pio
import random
import json
import os

# --------------------------
# --- REAL DATA PARSING ---
# --------------------------

def parse_branch_data(branch_data_text):
    """Parse the provided branch data text into a structured format"""
    branch_mapping = {
        'Khalidiya': 'Al_Khalidiyah',
        'Shabiya': 'Shabiya_11',
        'Barsha': 'Al_Barsha',
        'Satwa': 'Al_Satwa',
        'Al Rigga': 'Al_Rigga',
        'Electra': 'Electra'
    }
    
    # Split text into sections by branch
    sections = branch_data_text.strip().split('\n\n')
    branch_data = {}
    
    for section in sections:
        lines = section.strip().split('\n')
        if not lines:
            continue
            
        # Extract branch name
        branch_name = lines[0].strip()
        if branch_name == 'Month':
            continue  # Skip if it's the header
            
        # Map to internal branch name
        internal_branch = branch_mapping.get(branch_name, branch_name)
        
        # Initialize data structure
        branch_data[internal_branch] = {
            '2024_sales': [],
            '2024_orders': [],
            '2025_sales': [],
            '2025_orders': []
        }
        
        # Process data rows
        for line in lines[1:]:  # Skip branch name and header
            if line.startswith('Month'):
                continue
            if not line.strip():
                continue
                
            parts = line.split('\t')
            if len(parts) < 8:  # Ensure we have enough columns
                continue
                
            try:
                # Extract 2024 data
                orders_2024 = float(parts[5].replace(',', ''))
                sales_2024 = float(parts[6].replace(',', ''))
                
                # Extract 2025 data
                orders_2025 = float(parts[1].replace(',', ''))
                sales_2025 = float(parts[2].replace(',', ''))
                
                # Append to lists
                branch_data[internal_branch]['2024_orders'].append(orders_2024)
                branch_data[internal_branch]['2024_sales'].append(sales_2024)
                branch_data[internal_branch]['2025_orders'].append(orders_2025)
                branch_data[internal_branch]['2025_sales'].append(sales_2025)
                
            except (ValueError, IndexError) as e:
                print(f"Error processing line: {line}. Error: {e}")
                continue
    
    return branch_data

# --------------------------
# --- DASHBOARD GENERATION ---
# --------------------------

def generate_dashboard_html(branch_data, output_file="Crispy_Chicken_Dashboard.html"):
    """Generate the complete dashboard HTML with real data"""
    
    # Calculate key metrics
    total_revenue_2024 = sum(sum(branch_data[branch]['2024_sales']) for branch in branch_data)
    total_revenue_2025 = sum(sum(branch_data[branch]['2025_sales']) for branch in branch_data)
    growth_rate = ((total_revenue_2025 - total_revenue_2024) / total_revenue_2024) * 100 if total_revenue_2024 > 0 else 0
    
    # Create dashboard data structure
    dashboard_data = {
        'branches': list(branch_data.keys()),
        'branchNames': {name: f"Crispy Chicken - {name}" for name in branch_data.keys()},
        'months': ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        'monthNames': {month: month for month in ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']},
        'data2024': {
            'sales': {},
            'orders': {}
        },
        'data2025': {
            'sales': {},
            'orders': {}
        },
        'userEntries': []
    }
    
    # Populate data structure
    for branch in branch_data:
        dashboard_data['data2024']['sales'][branch] = branch_data[branch]['2024_sales']
        dashboard_data['data2024']['orders'][branch] = branch_data[branch]['2024_orders']
        dashboard_data['data2025']['sales'][branch] = branch_data[branch]['2025_sales']
        dashboard_data['data2025']['orders'][branch] = branch_data[branch]['2025_orders']
    
    # Calculate year metrics
    def calculate_year_metrics(year):
        data_year = dashboard_data[f'data{year}']
        total_sales = sum(sum(data_year['sales'][branch]) for branch in dashboard_data['branches'])
        total_orders = sum(sum(data_year['orders'][branch]) for branch in dashboard_data['branches'])
        avg_order_value = total_sales / total_orders if total_orders > 0 else 0
        
        # Calculate delivery metrics (assuming 81.4% for 2024 and 68.1% for 2025)
        delivery_percentage = 0.814 if year == 2024 else 0.681
        total_delivery_sales = total_sales * delivery_percentage
        total_delivery_orders = total_orders * delivery_percentage
        avg_delivery_value = total_delivery_sales / total_delivery_orders if total_delivery_orders > 0 else 0
        
        return {
            "totalSales": total_sales,
            "totalOrders": total_orders,
            "averageOrderValue": avg_order_value,
            "totalDeliverySales": total_delivery_sales,
            "totalDeliveryOrders": total_delivery_orders,
            "averageDeliveryValue": avg_delivery_value,
            "deliveryPercentage": delivery_percentage * 100
        }
    
    metrics2024 = calculate_year_metrics(2024)
    metrics2025 = calculate_year_metrics(2025)
    
    # Generate HTML content
    html_content = f"""<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Crispy Chicken Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {{
            --primary-color: #e74c3c;
            --secondary-color: #f39c12;
            --success-color: #27ae60;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --danger-color: #c0392b;
            --warning-color: #d68910;
            --online-color: #3498db;
            --year2024-color: #e74c3c;
            --year2025-color: #3498db;
        }}
        
        * {{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }}
        
        body {{
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
            color: var(--dark-color);
            line-height: 1.6;
        }}
        
        .container {{
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }}
        
        header {{
            background: linear-gradient(135deg, var(--primary-color), var(--danger-color));
            color: white;
            padding: 30px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }}
        
        header::before {{
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff20" fill-opacity="1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,144C960,149,1056,139,1152,128C1248,117,1344,107,1392,101.3L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') no-repeat bottom;
            background-size: cover;
        }}
        
        h1 {{
            font-size: 2.8rem;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 1;
        }}
        
        .subtitle {{
            text-align: center;
            font-size: 1.2rem;
            margin-top: 10px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }}
        
        .year-selector {{
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin: 20px auto;
            max-width: 1000px;
            text-align: center;
            backdrop-filter: blur(10px);
        }}
        
        .year-buttons {{
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }}
        
        .year-btn {{
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }}
        
        .year-btn:hover {{
            transform: translateY(-2px);
        }}
        
        .year-btn.active {{
            background: var(--primary-color);
            border-color: var(--primary-color);
        }}
        
        .dashboard {{
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
        }}
        
        .sidebar {{
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }}
        
        .sidebar h2 {{
            margin-bottom: 25px;
            color: var(--dark-color);
            font-size: 1.5rem;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 12px;
        }}
        
        .menu-item {{
            padding: 15px 20px;
            margin-bottom: 15px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }}
        
        .menu-item:hover {{
            background: var(--primary-color);
            color: white;
            transform: translateX(8px);
        }}
        
        .menu-item.active {{
            background: var(--primary-color);
            color: white;
        }}
        
        .menu-item i {{
            font-size: 1.3rem;
            width: 24px;
        }}
        
        .content {{
            background: white;
            border-radius: 15px;
            padding: 35px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
        }}
        
        .section {{
            display: none;
        }}
        
        .section.active {{
            display: block;
        }}
        
        .section h2 {{
            color: var(--dark-color);
            margin-bottom: 30px;
            font-size: 2rem;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
        }}
        
        .stats-grid {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }}
        
        .stat-card {{
            background: linear-gradient(135deg, #fff, #f8f9fa);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid;
        }}
        
        .stat-card.year2024 {{
            border-color: var(--year2024-color);
        }}
        
        .stat-card.year2025 {{
            border-color: var(--year2025-color);
        }}
        
        .stat-card.total {{
            border-color: var(--success-color);
        }}
        
        .stat-card h3 {{
            color: var(--dark-color);
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }}
        
        .stat-value {{
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
        }}
        
        .stat-card.year2024 .stat-value {{
            color: var(--year2024-color);
        }}
        
        .stat-card.year2025 .stat-value {{
            color: var(--year2025-color);
        }}
        
        .stat-card.total .stat-value {{
            color: var(--success-color);
        }}
        
        .stat-detail {{
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }}
        
        .stat-label {{
            color: #666;
        }}
        
        .stat-amount {{
            font-weight: 500;
        }}
        
        .chart-container {{
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            position: relative;
        }}
        
        .chart-container h3 {{
            margin-bottom: 20px;
            color: var(--dark-color);
            font-size: 1.4rem;
            border-bottom: 2px solid var(--light-color);
            padding-bottom: 10px;
        }}
        
        .outlet-grid {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }}
        
        .outlet-card {{
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
            border-top: 5px solid;
            position: relative;
            transition: all 0.3s ease;
        }}
        
        .outlet-card.year2024 {{
            border-color: var(--year2024-color);
        }}
        
        .outlet-card.year2025 {{
            border-color: var(--year2025-color);
        }}
        
        .outlet-card h3 {{
            margin-bottom: 20px;
            font-size: 1.3rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }}
        
        .outlet-stats {{
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }}
        
        .outlet-stat {{
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }}
        
        .outlet-stat-label {{
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }}
        
        .outlet-stat-value {{
            font-size: 1.5rem;
            font-weight: 700;
        }}
        
        .outlet-card.year2024 .outlet-stat-value {{
            color: var(--year2024-color);
        }}
        
        .outlet-card.year2025 .outlet-stat-value {{
            color: var(--year2025-color);
        }}
        
        .comparison-badge {{
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-top: 10px;
        }}
        
        .comparison-badge.positive {{
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--success-color);
        }}
        
        .comparison-badge.negative {{
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger-color);
        }}
        
        .comparison-badge.neutral {{
            background-color: rgba(243, 156, 18, 0.1);
            color: var(--warning-color);
        }}
        
        .delivery-trends-table {{
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.06);
            border-radius: 10px;
            overflow: hidden;
        }}
        
        .delivery-trends-table th {{
            background: linear-gradient(135deg, var(--primary-color), var(--danger-color));
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: 500;
            font-size: 1rem;
        }}
        
        .delivery-trends-table td {{
            padding: 12px;
            border-bottom: 1px solid #eee;
        }}
        
        .delivery-trends-table tr:nth-child(even) {{
            background-color: #f9f9f9;
        }}
        
        .delivery-trends-table tr:hover {{
            background-color: #fff5f5;
            transition: background-color 0.2s ease;
        }}
        
        .branch-name {{
            font-weight: 500;
        }}
        
        .trend-cell {{
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }}
        
        .trend-up {{
            color: var(--success-color);
        }}
        
        .trend-down {{
            color: var(--danger-color);
        }}
        
        .trend-neutral {{
            color: var(--warning-color);
        }}
        
        .table-container {{
            overflow-x: auto;
            margin-bottom: 30px;
        }}
        
        .insight-box {{
            background: linear-gradient(135deg, #e8f5e9, #f1f8e9);
            border-left: 5px solid var(--success-color);
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            position: relative;
        }}
        
        .insight-box h4 {{
            color: var(--success-color);
            margin-bottom: 10px;
            font-size: 1.2rem;
        }}
        
        .insight-box p {{
            color: #666;
            line-height: 1.6;
        }}
        
        .insights-grid {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }}
        
        .insight-card {{
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
            position: relative;
            transition: all 0.3s ease;
        }}
        
        .insight-card h4 {{
            color: var(--dark-color);
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }}
        
        .insight-card p {{
            color: #666;
            line-height: 1.6;
        }}
        
        .insight-metric {{
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }}
        
        .insight-metric-value {{
            font-size: 1.5rem;
            font-weight: 700;
        }}
        
        .insight-metric-label {{
            color: #666;
            font-size: 0.9rem;
        }}
        
        .alert {{
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid;
        }}
        
        .alert-success {{
            background-color: rgba(39, 174, 96, 0.1);
            border-color: var(--success-color);
            color: var(--success-color);
        }}
        
        .alert-info {{
            background-color: rgba(52, 152, 219, 0.1);
            border-color: var(--online-color);
            color: var(--online-color);
        }}
        
        .real-time-indicator {{
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(39, 174, 96, 0.1);
            color: var(--success-color);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }}
        
        .real-time-dot {{
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success-color);
            animation: pulse 2s infinite;
        }}
        
        @keyframes pulse {{
            0% {{
                box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7);
            }}
            70% {{
                box-shadow: 0 0 0 10px rgba(39, 174, 96, 0);
            }}
            100% {{
                box-shadow: 0 0 0 0 rgba(39, 174, 96, 0);
            }}
        }}
        
        @media (max-width: 1024px) {{
            .dashboard {{
                grid-template-columns: 1fr;
            }}
            
            .sidebar {{
                position: static;
            }}
        }}
        
        @media (max-width: 768px) {{
            .container {{
                padding: 10px;
            }}
            
            h1 {{
                font-size: 2rem;
            }}
            
            .content {{
                padding: 20px;
            }}
            
            .stats-grid {{
                grid-template-columns: 1fr;
            }}
            
            .year-buttons {{
                flex-direction: column;
                align-items: center;
            }}
            
            .year-btn {{
                width: 100%;
                max-width: 300px;
            }}
        }}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="real-time-indicator">
                <div class="real-time-dot"></div>
                <span>Real-time Updates</span>
            </div>
            <h1><i class="fas fa-chart-line"></i> Crispy Chicken Dashboard</h1>
            <div class="subtitle">Interactive Comparison Between 2024 and 2025 Performance</div>
        </header>

        <div class="year-selector">
            <h3>Select Year for Analysis</h3>
            <div class="year-buttons">
                <button class="year-btn year2024 active" data-year="2024">
                    <i class="fas fa-calendar-alt"></i> 2024
                </button>
                <button class="year-btn year2025" data-year="2025">
                    <i class="fas fa-calendar-plus"></i> 2025
                </button>
                <button class="year-btn" data-year="comparison" style="background: var(--success-color); border-color: var(--success-color);">
                    <i class="fas fa-balance-scale"></i> Compare Both Years
                </button>
            </div>
        </div>

        <div class="dashboard">
            <aside class="sidebar">
                <h2><i class="fas fa-bars"></i> Navigation</h2>
                <div class="menu-item active" data-section="overview">
                    <i class="fas fa-tachometer-alt"></i> <span>Overview</span>
                </div>
                <div class="menu-item" data-section="branch-analysis">
                    <i class="fas fa-store"></i> <span>Branch Analysis</span>
                </div>
                <div class="menu-item" data-section="delivery-trends">
                    <i class="fas fa-truck"></i> <span>Delivery Trends</span>
                </div>
                <div class="menu-item" data-section="monthly-comparison">
                    <i class="fas fa-calendar-alt"></i> <span>Monthly Trends</span>
                </div>
                <div class="menu-item" data-section="insights">
                    <i class="fas fa-lightbulb"></i> <span>Key Insights</span>
                </div>
            </aside>

            <main class="content">
                <!-- Overview Section -->
                <section id="overview" class="section active">
                    <h2><i class="fas fa-chart-pie"></i> Performance Overview</h2>
                    
                    <div class="alert alert-success">
                        <h3><i class="fas fa-check-circle"></i> Network Performance Summary</h3>
                        <p>Compare total sales and performance metrics between 2024 and 2025 across all branches.</p>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card year2024">
                            <h3><i class="fas fa-chart-line"></i> 2024 Performance</h3>
                            <div class="stat-value">${metrics2024['totalSales']:,}</div>
                            <div class="stat-detail">
                                <span class="stat-label">Total Transactions:</span>
                                <span class="stat-amount">{metrics2024['totalOrders']:,}</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Delivery Sales:</span>
                                <span class="stat-amount">${metrics2024['totalDeliverySales']:,}</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Average Value:</span>
                                <span class="stat-amount">${metrics2024['averageOrderValue']:.2f}</span>
                            </div>
                        </div>
                        
                        <div class="stat-card year2025">
                            <h3><i class="fas fa-chart-line"></i> 2025 Performance</h3>
                            <div class="stat-value">${metrics2025['totalSales']:,}</div>
                            <div class="stat-detail">
                                <span class="stat-label">Total Transactions:</span>
                                <span class="stat-amount">{metrics2025['totalOrders']:,}</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Delivery Sales:</span>
                                <span class="stat-amount">${metrics2025['totalDeliverySales']:,}</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Average Value:</span>
                                <span class="stat-amount">${metrics2025['averageOrderValue']:.2f}</span>
                            </div>
                        </div>
                        
                        <div class="stat-card total">
                            <h3><i class="fas fa-balance-scale"></i> Comparison Summary</h3>
                            <div class="stat-value">{growth_rate:.1f}%</div>
                            <div class="stat-detail">
                                <span class="stat-label">Sales Growth:</span>
                                <span class="stat-amount">${metrics2025['totalSales'] - metrics2024['totalSales']:,}</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Transaction Change:</span>
                                <span class="stat-amount">{((metrics2025['totalOrders'] - metrics2024['totalOrders']) / metrics2024['totalOrders'] * 100):.1f}%</span>
                            </div>
                            <div class="stat-detail">
                                <span class="stat-label">Data Status:</span>
                                <span class="stat-amount">2025 partial data</span>
                            </div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h3><i class="fas fa-chart-bar"></i> Year-over-Year Comparison</h3>
                        <canvas id="year-overview-chart"></canvas>
                    </div>

                    <div class="insight-box">
                        <h4><i class="fas fa-lightbulb"></i> Key Insight</h4>
                        <p>{'Sales increased by ' + str(growth_rate) + '% in 2025 compared to 2024. Average order value increased by ' + str(((metrics2025['averageOrderValue'] - metrics2024['averageOrderValue']) / metrics2024['averageOrderValue'] * 100):.1f) + '%.' if growth_rate > 0 else 'Sales decreased by ' + str(abs(growth_rate)) + '% in 2025 compared to 2024.'}</p>
                    </div>
                </section>

                <!-- Branch Analysis Section -->
                <section id="branch-analysis" class="section">
                    <h2><i class="fas fa-store"></i> Branch Performance Analysis</h2>
                    
                    <div class="outlet-grid" id="outlet-grid">
                        <!-- Outlet cards will be populated by JavaScript -->
                    </div>

                    <div class="chart-container">
                        <h3><i class="fas fa-chart-bar"></i> Branch Sales Comparison</h3>
                        <canvas id="branch-comparison-chart"></canvas>
                    </div>
                </section>

                <!-- Delivery Trends Section -->
                <section id="delivery-trends" class="section">
                    <h2><i class="fas fa-truck"></i> Branch Delivery Trends</h2>
                    
                    <div class="alert alert-info">
                        <h3><i class="fas fa-info-circle"></i> Delivery Performance Analysis</h3>
                        <p>Compare delivery counts and amounts between 2024 and 2025 for all branches.</p>
                    </div>

                    <div class="chart-container">
                        <h3><i class="fas fa-table"></i> Delivery Counts Comparison</h3>
                        <div class="table-container">
                            <table class="delivery-trends-table">
                                <thead>
                                    <tr>
                                        <th>Branch</th>
                                        <th colspan="3">January</th>
                                        <th colspan="3">February</th>
                                        <th colspan="3">March</th>
                                        <th colspan="3">April</th>
                                        <th colspan="3">May</th>
                                        <th colspan="3">June</th>
                                        <th colspan="3">July</th>
                                        <th colspan="3">August</th>
                                        <th colspan="3">September</th>
                                    </tr>
                                    <tr>
                                        <th></th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                        <th>2024</th>
                                        <th>2025</th>
                                        <th>Change</th>
                                    </tr>
                                </thead>
                                <tbody id="delivery-counts-tbody">
                                    <!-- Table rows will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Monthly Trends Section -->
                <section id="monthly-comparison" class="section">
                    <h2><i class="fas fa-calendar-alt"></i> Monthly Performance Trends</h2>
                    
                    <div class="chart-container">
                        <h3><i class="fas fa-chart-line"></i> Monthly Sales Comparison</h3>
                        <canvas id="monthly-sales-chart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3><i class="fas fa-chart-bar"></i> Monthly Transaction Volume</h3>
                        <canvas id="monthly-transactions-chart"></canvas>
                    </div>
                </section>

                <!-- Insights Section -->
                <section id="insights" class="section">
                    <h2><i class="fas fa-lightbulb"></i> Key Insights & Analysis</h2>
                    
                    <div class="alert alert-success">
                        <h3><i class="fas fa-chart-line"></i> Performance Insights</h3>
                        <p>Comprehensive analysis of business performance between 2024 and 2025.</p>
                    </div>

                    <div class="insights-grid">
                        <div class="insight-card">
                            <h4><i class="fas fa-trophy"></i> Top Performing Branch (2024)</h4>
                            <p>Electra branch led with ${sum(branch_data[branch]['2024_sales']) for branch in branch_data):,} in sales.</p>
                            <div class="insight-metric">
                                <div class="insight-metric-value">${sum(branch_data[branch]['2024_sales']) for branch in branch_data):,}</div>
                                <div class="insight-metric-label">Total Sales</div>
                            </div>
                        </div>

                        <div class="insight-card">
                            <h4><i class="fas fa-chart-line"></i> Sales Trend Analysis</h4>
                            <p>Average order value increased by {((metrics2025['averageOrderValue'] - metrics2024['averageOrderValue']) / metrics2024['averageOrderValue'] * 100):.1f}%.</p>
                            <div class="insight-metric">
                                <div class="insight-metric-value">{((metrics2025['averageOrderValue'] - metrics2024['averageOrderValue']) / metrics2024['averageOrderValue'] * 100):.1f}%</div>
                                <div class="insight-metric-label">Avg Value Change</div>
                            </div>
                        </div>

                        <div class="insight-card">
                            <h4><i class="fas fa-mobile-alt"></i> Channel Performance</h4>
                            <p>Delivery channel market share decreased from {metrics2024['deliveryPercentage']:.1f}% to {metrics2025['deliveryPercentage']:.1f}%.</p>
                            <div class="insight-metric">
                                <div class="insight-metric-value">{((metrics2025['deliveryPercentage'] - metrics2024['deliveryPercentage']) / metrics2024['deliveryPercentage'] * 100):.1f}%</div>
                                <div class="insight-metric-label">Delivery Channel Change</div>
                            </div>
                        </div>

                        <div class="insight-card">
                            <h4><i class="fas fa-calendar-alt"></i> Seasonal Patterns</h4>
                            <p>Summer months (June-August) account for {(sum(sum(branch_data[branch]['2024_sales'][5:8]) for branch in branch_data) / sum(sum(branch_data[branch]['2024_sales']) for branch in branch_data) * 100):.1f}% of total sales.</p>
                            <div class="insight-metric">
                                <div class="insight-metric-value">{(sum(sum(branch_data[branch]['2024_sales'][5:8]) for branch in branch_data) / sum(sum(branch_data[branch]['2024_sales']) for branch in branch_data) * 100):.1f}%</div>
                                <div class="insight-metric-label">Summer Sales Share</div>
                            </div>
                        </div>

                        <div class="insight-card">
                            <h4><i class="fas fa-bullseye"></i> Growth Opportunities</h4>
                            <p>Potential to increase order volume by {metrics2024['totalOrders'] - metrics2025['totalOrders']:,.0f} orders by improving delivery efficiency.</p>
                            <div class="insight-metric">
                                <div class="insight-metric-value">{metrics2024['totalOrders'] - metrics2025['totalOrders']:,.0f}</div>
                                <div class="insight-metric-label">Potential Order Volume</div>
                            </div>
                        </div>

                        <div class="insight-card">
                            <h4><i class="fas fa-exclamation-triangle"></i> Areas for Improvement</h4>
                            <p>Sales declined by {abs(growth_rate):.1f}% in 2025, requiring strategic interventions.</p>
                            <div class="insight-metric">
                                <div class="insight-metric-value">{abs(growth_rate):.1f}%</div>
                                <div class="insight-metric-label">Sales Decline</div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script>
        // Dashboard data
        const dashboardData = {json.dumps(dashboard_data)};
        
        // Initialize charts
        document.addEventListener('DOMContentLoaded', function() {{
            // Initialize Year Overview Chart
            const yearCtx = document.getElementById('year-overview-chart').getContext('2d');
            new Chart(yearCtx, {{
                type: 'bar',
                data: {{
                    labels: ['Total Sales', 'Total Orders', 'Avg Order Value', 'Delivery Sales', 'Delivery Orders'],
                    datasets: [{{
                        label: '2024',
                        data: [
                            {metrics2024['totalSales']},
                            {metrics2024['totalOrders']},
                            {metrics2024['averageOrderValue']},
                            {metrics2024['totalDeliverySales']},
                            {metrics2024['totalDeliveryOrders']}
                        ],
                        backgroundColor: 'rgba(231, 76, 60, 0.7)',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        borderWidth: 1
                    }}, {{
                        label: '2025',
                        data: [
                            {metrics2025['totalSales']},
                            {metrics2025['totalOrders']},
                            {metrics2025['averageOrderValue']},
                            {metrics2025['totalDeliverySales']},
                            {metrics2025['totalDeliveryOrders']}
                        ],
                        backgroundColor: 'rgba(52, 152, 219, 0.7)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    }}]
                }},
                options: {{
                    responsive: true,
                    plugins: {{
                        legend: {{
                            position: 'top',
                        }},
                        title: {{
                            display: true,
                            text: 'Year-over-Year Performance Comparison'
                        }}
                    }},
                    scales: {{
                        y: {{
                            beginAtZero: true,
                            ticks: {{
                                callback: function(value) {{
                                    if (this.chart.data.labels[this.dataIndex] === 'Total Sales' || 
                                        this.chart.data.labels[this.dataIndex] === 'Delivery Sales') {{
                                        return '$' + value.toLocaleString();
                                    }}
                                    return value.toLocaleString();
                                }}
                            }}
                        }}
                    }}
                }}
            }});

            // Initialize Branch Comparison Chart
            const branchCtx = document.getElementById('branch-comparison-chart').getContext('2d');
            const branchLabels = {json.dumps(dashboard_data['branches'])};
            const branchData2024 = {json.dumps([sum(dashboard_data['data2024']['sales'][branch]) for branch in dashboard_data['branches']])};
            const branchData2025 = {json.dumps([sum(dashboard_data['data2025']['sales'][branch]) for branch in dashboard_data['branches']])};
            
            new Chart(branchCtx, {{
                type: 'bar',
                data: {{
                    labels: branchLabels,
                    datasets: [{{
                        label: '2024 Sales',
                        data: branchData2024,
                        backgroundColor: 'rgba(231, 76, 60, 0.7)',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        borderWidth: 1
                    }}, {{
                        label: '2025 Sales',
                        data: branchData2025,
                        backgroundColor: 'rgba(52, 152, 219, 0.7)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    }}]
                }},
                options: {{
                    responsive: true,
                    plugins: {{
                        legend: {{
                            position: 'top',
                        }},
                        title: {{
                            display: true,
                            text: 'Branch Sales Comparison'
                        }}
                    }},
                    scales: {{
                        y: {{
                            beginAtZero: true,
                            ticks: {{
                                callback: function(value) {{
                                    return '$' + value.toLocaleString();
                                }}
                            }}
                        }}
                    }}
                }}
            }});

            // Populate Outlet Cards
            const outletGrid = document.getElementById('outlet-grid');
            outletGrid.innerHTML = '';
            
            {json.dumps(dashboard_data['branches'])}.forEach(branch => {{
                const sales2024 = {json.dumps([sum(dashboard_data['data2024']['sales'][branch]) for branch in dashboard_data['branches']])};
                const sales2025 = {json.dumps([sum(dashboard_data['data2025']['sales'][branch]) for branch in dashboard_data['branches']])};
                const growth = ((sales2025 - sales2024) / sales2024 * 100).toFixed(1);
                const badgeClass = growth > 0 ? 'positive' : growth < 0 ? 'negative' : 'neutral';
                
                const card = document.createElement('div');
                card.className = `outlet-card ${{growth > 0 ? 'year2025' : 'year2024'}}`;
                card.innerHTML = `
                    <h3>
                        {json.dumps(dashboard_data['branchNames'])[branch]}
                        <span class="comparison-badge ${{badgeClass}}">
                            ${{growth > 0 ? '+' : ''}}${{growth}}%
                        </span>
                    </h3>
                    <div class="outlet-stats">
                        <div class="outlet-stat">
                            <div class="outlet-stat-label">2024 Sales</div>
                            <div class="outlet-stat-value">${{$sales2024.toLocaleString()}}</div>
                        </div>
                        <div class="outlet-stat">
                            <div class="outlet-stat-label">2025 Sales</div>
                            <div class="outlet-stat-value">${{$sales2025.toLocaleString()}}</div>
                        </div>
                    </div>
                `;
                outletGrid.appendChild(card);
            }});

            // Populate Delivery Counts Table
            const deliveryTbody = document.getElementById('delivery-counts-tbody');
            deliveryTbody.innerHTML = '';
            
            {json.dumps(dashboard_data['branches'])}.forEach(branch => {{
                const row = document.createElement('tr');
                row.innerHTML = `<td class="branch-name">${{json.dumps(dashboard_data['branchNames'])[branch]}}</td>`;
                
                {json.dumps(dashboard_data['months'])}.forEach((month, index) => {{
                    const count2024 = {json.dumps(dashboard_data['data2024']['orders'])[branch][index]};
                    const count2025 = {json.dumps(dashboard_data['data2025']['orders'])[branch][index]};
                    const change = count2024 > 0 ? ((count2025 - count2024) / count2024 * 100).toFixed(1) : 0;
                    
                    row.innerHTML += `
                        <td>${{count2024}}</td>
                        <td>${{count2025}}</td>
                        <td class="trend-cell">
                            <span class="${{change > 0 ? 'trend-up' : change < 0 ? 'trend-down' : 'trend-neutral'}}">
                                ${{change > 0 ? '+' : ''}}${{change}}%
                            </span>
                        </td>
                    `;
                }});
                
                deliveryTbody.appendChild(row);
            }});

            // Initialize Monthly Charts
            const monthlySalesCtx = document.getElementById('monthly-sales-chart').getContext('2d');
            const monthlyTransactionsCtx = document.getElementById('monthly-transactions-chart').getContext('2d');
            
            const monthlySales2024 = {json.dumps([sum([dashboard_data['data2024']['sales'][branch][i] for branch in dashboard_data['branches']]) for i in range(12)])};
            const monthlySales2025 = {json.dumps([sum([dashboard_data['data2025']['sales'][branch][i] for branch in dashboard_data['branches']]) for i in range(12)])};
            const monthlyOrders2024 = {json.dumps([sum([dashboard_data['data2024']['orders'][branch][i] for branch in dashboard_data['branches']]) for i in range(12)])};
            const monthlyOrders2025 = {json.dumps([sum([dashboard_data['data2025']['orders'][branch][i] for branch in dashboard_data['branches']]) for i in range(12)])};
            
            new Chart(monthlySalesCtx, {{
                type: 'line',
                data: {{
                    labels: {json.dumps([dashboard_data['monthNames'][month] for month in dashboard_data['months']])},
                    datasets: [{{
                        label: '2024 Sales',
                        data: monthlySales2024,
                        borderColor: 'rgba(231, 76, 60, 1)',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        fill: true
                    }}, {{
                        label: '2025 Sales',
                        data: monthlySales2025,
                        borderColor: 'rgba(52, 152, 219, 1)',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        fill: true
                    }}]
                }},
                options: {{
                    responsive: true,
                    plugins: {{
                        legend: {{
                            position: 'top',
                        }},
                        title: {{
                            display: true,
                            text: 'Monthly Sales Comparison'
                        }}
                    }},
                    scales: {{
                        y: {{
                            beginAtZero: true,
                            ticks: {{
                                callback: function(value) {{
                                    return '$' + value.toLocaleString();
                                }}
                            }}
                        }}
                    }}
                }}
            }});

            new Chart(monthlyTransactionsCtx, {{
                type: 'bar',
                data: {{
                    labels: {json.dumps([dashboard_data['monthNames'][month] for month in dashboard_data['months']])},
                    datasets: [{{
                        label: '2024 Orders',
                        data: monthlyOrders2024,
                        backgroundColor: 'rgba(231, 76, 60, 0.7)',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        borderWidth: 1
                    }}, {{
                        label: '2025 Orders',
                        data: monthlyOrders2025,
                        backgroundColor: 'rgba(52, 152, 219, 0.7)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    }}]
                }},
                options: {{
                    responsive: true,
                    plugins: {{
                        legend: {{
                            position: 'top',
                        }},
                        title: {{
                            display: true,
                            text: 'Monthly Transaction Volume'
                        }}
                    }},
                    scales: {{
                        y: {{
                            beginAtZero: true,
                            ticks: {{
                                callback: function(value) {{
                                    return value.toLocaleString();
                                }}
                            }}
                        }}
                    }}
                }}
            }});

            // Navigation functionality
            document.querySelectorAll('.menu-item').forEach(item => {{
                item.addEventListener('click', function() {{
                    document.querySelectorAll('.menu-item').forEach(menu => menu.classList.remove('active'));
                    this.classList.add('active');
                    
                    const targetSection = this.dataset.section;
                    document.querySelectorAll('.section').forEach(section => {{
                        section.classList.remove('active');
                    }});
                    document.getElementById(targetSection).classList.add('active');
                }});
            }});

            // Year selection functionality
            document.querySelectorAll('.year-btn').forEach(button => {{
                button.addEventListener('click', function() {{
                    document.querySelectorAll('.year-btn').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    const selectedYear = this.dataset.year;
                    updateDashboard(selectedYear);
                }});
            }});

            function updateDashboard(year) {{
                // Update stat cards based on year selection
                if (year === '2024') {{
                    document.querySelectorAll('.stat-card.year2025, .outlet-card.year2025').forEach(card => {{
                        card.style.opacity = '0.5';
                        card.style.transform = 'scale(0.98)';
                    }});
                    document.querySelectorAll('.stat-card.year2024, .outlet-card.year2024').forEach(card => {{
                        card.style.opacity = '1';
                        card.style.transform = 'scale(1)';
                    }});
                }} else if (year === '2025') {{
                    document.querySelectorAll('.stat-card.year2024, .outlet-card.year2024').forEach(card => {{
                        card.style.opacity = '0.5';
                        card.style.transform = 'scale(0.98)';
                    }});
                    document.querySelectorAll('.stat-card.year2025, .outlet-card.year2025').forEach(card => {{
                        card.style.opacity = '1';
                        card.style.transform = 'scale(1)';
                    }});
                }} else if (year === 'comparison') {{
                    document.querySelectorAll('.stat-card, .outlet-card').forEach(card => {{
                        card.style.opacity = '1';
                        card.style.transform = 'scale(1)';
                    }});
                }}
            }}
        }});
    </script>
</body>
</html>
"""
    
    # Write the HTML file
    with open(output_file, 'w', encoding='utf-8') as f:
        f.write(html_content)
    
    print(f"Dashboard generated successfully: {output_file}")

# --------------------------
# --- MAIN EXECUTION ---
# --------------------------

if __name__ == "__main__":
    # Your provided branch data
    branch_data_text = """
    Hamdan												
    Month	2025 Orders	2025 Sales	2025 online  Orders	2025 online  Sales	2025 Total Orders	2025 Total Sales	2024 Orders	2024 Sales	2024 online  Orders	2024 online  Sales	2024 Total Orders	2024 Total Sales
    Jan	2757	119,300	569	25,546	3326	144,846	2,797	130,332	771	39,204	3568	169,536
    Feb	2460	111,546	644	28,689	3104	140,235	2,797	119,033	661	33,373	3458	152,406
    Mar	1877	87,783	493	23,967	2370	111,750	2,474	112,730	615	29,535	3089	142,265
    Apr	2363	106,625	750	35,261	3113	141,886	2,815	134,005	674	33,433	3489	167,438
    May	2515	117,066	905	39,090	3420	156,156	3,066	142,948	733	35,454	3799	178,402
    Jun	2318	106,229	800	38,061	3118	144,290	3,261	153,855	825	40,787	4086	194,642
    Jul	2557	109,205	1007	41,582	3564	150,787	3,236	140,646	876	39,832	4112	180,478
    Aug	2247	103,184	771	34,835	3018	138,019	3,267	146,010	756	32,362	4023	178,372
    Sep	2345	106,561	889	41,146	3234	147,707	2,658	124,891	547	27,887	3205	152,778
    Oct	0	0	0	0	0	0	0	0	0	0	0	0
    Nov	0	0	0	0	0	0	0	0	0	0	0	0
    Dec	0	0	0	0	0	0	0	0	0	0	0	0
    Total	21439	967499	6828	308177	28267	1275676	26371	1204450	6458	311867	32829	1516317
    Khalidiya												
    Month	2025 Orders	2025 Sales	2025 online  Orders	2025 online  Sales	2025 Total Orders	2025 Total Sales	2024 Orders	2024 Sales	2024 online  Orders	2024 online  Sales	2024 Total Orders	2024 Total Sales
    Jan	1241	60,360	292	13,749	1533	74109	1,444	73,203	412	21,135	1,856	94338
    Feb	1054	51,718	305	14,662	1359	66380	1,270	64,910	417	21,217	1687	86127
    Mar	891	44,621	198	12,644	1089	57265	1,114	56,006	321	16,169	1435	72175
    Apr	1156	54,785	312	16,370	1468	71155	1,268	63,867	390	20,903	1658	84770
    May	1083	54,610	439	20,318	1522	74928	1,423	71,236	366	19,685	1789	90921
    Jun	1078	56,860	377	19,102	1455	75962	1,467	78,402	399	21,759	1866	100161
    Jul	1097	51,618	426	17,766	1523	69384	1,438	72,570	447	22,254	1885	94824
    Aug	1032	51,039	365	17,361	1397	68400	1,505	70,910	388	18,936	1893	89846
    Sep	1144	57,769	316	16,495	1460	74264	1,264	61,308	281	14,826	1545	76134
    Oct	0	0	0	0	0	0	0	0	0	0	0	0
    Nov	0	0	0	0	0	0	0	0	0	0	0	0
    Dec	0	0	0	0	0	0	0	0	0	0	0	0
    Total	9776	483380.4	3030	148466.6	12806	631847	12193	612412	3421	176884	15614	789296
    Shabiya												
    Month	2025 Orders	2025 Sales	2025 online  Orders	2025 online  Sales	2025 Total Orders	2025 Total Sales	2024 Orders	2024 Sales	2024 online  Orders	2024 online  Sales	2024 Total Orders	2024 Total Sales
    Jan	1201	52,778	177	7,398	1378	60176	1,184	53,600	244	11,054	1,428	64654
    Feb	1136	51,105	143	6,340	1279	57445	1,260	56,902	222	11,743	1482	68645
    Mar	906	40,273	74	3,282	980	43555	1,167	50,445	179	8,011	1346	58456
    Apr	1246	56,981	245	6,103	1491	63084	1,434	63,642	163	7,720	1597	71362
    May	1187	56,703	308	6,438	1495	63141	1,380	62,211	204	10,015	1584	72226
    Jun	1114	54,611	306	6,600	1420	61211	1,396	64,920	238	11,933	1634	76853
    Jul	1177	55,160	404	16,910	1581	72070	1,366	60,095	223	9,793	1589	69888
    Aug	1162	55,336	260	12,568	1422	67904	1,388	58,704	237	11,299	1625	70003
    Sep	1269	61,290	216	10,420	1485	71709.6	1,135	50,504	179	8,747	1314	59251
    Oct	0	0	0	0	0	0	0	0	0	0	0	0
    Nov	0	0	0	0	0	0	0	0	0	0	0	0
    Dec	0	0	0	0	0	0	0	0	0	0	0	0
    Total	10398	484236.6	2133	76059	12531	560295.6	11710	521023	1889	90315	13599	611338
    Muroor												
    Month	2025 Orders	2025 Sales	2025 online  Orders	2025 online  Sales	2025 Total Orders	2025 Total Sales	2024 Orders	2024 Sales	2024 online  Orders	2024 online  Sales	2024 Total Orders	2024 Total Sales
    Jan	1255	59,749	72	3,352	1327	63101	1,140	56,696	154	8,231	1,294	64927
    Feb	1199	58,438	74	3,939	1273	62377	1,078	54,156	199	11,050	1277	65206
    Mar	817	41,808	67	3,831	884	45639	899	45,652	143	7,874	1042	53526
    Apr	1211	56,795	113	9,647	1324	66442	1,209	59,978	140	8,167	1349	68145
    May	1094	54,302	131	9,039	1225	63341	1,294	61,958	174	9,704	1468	71662
    Jun	1076	56,046	120	7,877	1196	63923	1,341	71,109	191	10,966	1532	82075
    Jul	1114	53,001	125	6,127	1239	59128	1,360	63,143	176	9,358	1536	72501
    Aug	912	44,361	116	5,884	1028	50245	1,386	64,842	157	8,392	1543	73234
    Sep	973	46,523	119	6,668	1092	53190.8	1,295	61,113	146	7,504	1441	68617
    Oct	0	0	0	0	0	0	0	0	0	0	0	0
    Nov	0	0	0	0	0	0	0	0	0	0	0	0
    Dec	0	0	0	0	0	0	0	0	0	0	0	0
    Total	9651	471023	937	56363.8	10588	527386.8	11002	538647	1480	81246	12482	619893
    Electra												
    Month	2025 Orders	2025 Sales	2025 online  Orders	2025 online  Sales	2025 Total Orders	2025 Total Sales	2024 Orders	2024 Sales	2024 online  Orders	2024 online  Sales	2024 Total Orders	2024 Total Sales
    Jan	0	0	0	0	0	0	0	0	0	0	0	0
    Feb	0	0	0	0	0	0	0	0	0	0	0	0
    Mar	0	0	0	0	0	0	0	0	0	0	0	0
    Apr	0	0	0	0	0	0	0	0	0	0	0	0
    May	0	0	0	0	0	0	0	0	0	0	0	0
    Jun	0	0	0	0	0	0	0	0	0	0	0	0
    Jul	0	0	0	0	0	0	0	0	0	0	0	0
    Aug	0	0	0	0	0	0	0	0	0	0	0	0
    Sep	0	0	0	0	0	0	0	0	0	0	0	0
    Oct	0	0	0	0	0	0	0	0	0	0	0	0
    Nov	0	0	0	0	0	0	0	0	0	0	0	0
    Dec	0	0	0	0	0	0	0	0	0	0	0	0
    Total	0	0	0	0	0	0	0	0	0	0	0	0
    Barsha												
    Month	2025 Orders	2025 Sales	2025 online  Orders	2025 online  Sales	2025 Total Orders	2025 Total Sales	2024 Orders	2024 Sales	2024 online  Orders	2024 online  Sales	2024 Total Orders	2024 Total Sales
    Jan	1726	55752	156	8325	1882	64077	802	30120	365	19348	1,167	49468
    Feb	1527	51699	178	8977	1705	60676	928	33556	304	16597	1232	50153
    Mar	1427	42075	98	4816	1525	46891	928	30722	243	14043	1171	44765
    Apr	1816	61422	181	9647	1997	71069	1173	40737	221	12546	1394	53283
    May	881	36988	176	9039	1057	46027	1487	50460	290	16921	1777	67381
    Jun	891	41436	161	7877	1052	49313	1488	48778	299	17351	1787	66129
    Jul	1007	44627	173	8453	1180	53080	1740	56252	276	14681	2016	70933
    Aug	901	49296	159	7404	1060	56700	1813	54008	250	13840	2063	67848
    Sep	879	43360.8	167	8489.9	1046	51850.7	1749	54921	203	12385	1952	67306
    Oct	0	0	0	0	0	0	0	0	0	0	0	0
    Nov	0	0	0	0	0	0	0	0	0	0	0	0
    Dec	0	0	0	0	0	0	0	0	0	0	0	0
    Total	11055	426655.8	1449	73027.9	12504	499683.7	12108	399554	2451	137712	14559	537266
    Satwa												
    Month	2025 Orders	2025 Sales	2025 online  Orders	2025 online  Sales	2025 Total Orders	2025 Total Sales	2024 Orders	2024 Sales	2024 online  Orders	2024 online  Sales	2024 Total Orders	2024 Total Sales
    Jan	818	26849	210	7572	1028	34421	0	0	0	0	0	0
    Feb	719	24349	240	9979	959	34328	0	0	0	0	0	0
    Mar	645	21934	134	5832	779	27766	0	0	0	0	0	0
    Apr	881	29154	283	11509	1164	40663	0	0	0	0	0	0
    May	506	20631	348	13388	854	34019	555	22337	15	569	570	22906
    Jun	463	21005	343	13815	806	34820	684	26665	148	6303	832	32968
    Jul	528	24685	484	18083	1012	42768	795	27671	234	9685	1029	37356
    Aug	492	22476	387	14903	879	37379	965	34732	299	11818	1264	46550
    Sep	495	23066	376	15232	871	38298	799	27068	177	8026	976	35094
    Oct	0	0	0	0	0	0	0	0	0	0	0	0
    Nov	0	0	0	0	0	0	0	0	0	0	0	0
    Dec	0	0	0	0	0	0	0	0	0	0	0	0
    Total	5547	214149	2805	110313	8352	324462	3798	138473	873	36401	4671	174874
    Al Rigga												
    Month	2025 Orders	2025 Sales	2025 online  Orders	2025 online  Sales	2025 Total Orders	2025 Total Sales	2024 Orders	2024 Sales	2024 online  Orders	2024 online  Sales	2024 Total Orders	2024 Total Sales
    Jan	0	0	0	0	0	0	0	0	0	0	0	0
    Feb	0	0	0	0	0	0	0	0	0	0	0	0
    Mar	0	0	0	0	0	0	0	0	0	0	0	0
    Apr	0	0	0	0	0	0	0	0	0	0	0	0
    May	0	0	0	0	0	0	0	0	0	0	0	0
    Jun	0	0	0	0	0	0	0	0	0	0	0	0
    Jul	0	0	0	0	0	0	0	0	0	0	0	0
    Aug	0	0	0	0	0	0	0	0	0	0	0	0
    Sep	45	1993	0	0	45	1993	0	0	0	0	0	0
    Oct	0	0	0	0	0	0	0	0	0	0	0	0
    Nov	0	0	0	0	0	0	0	0	0	0	0	0
    Dec	0	0	0	0	0	0	0	0	0	0	0	0
    Total	45	1993	0	0	45	1993	0	0	0	0	0	0
    """
    
    # Parse the branch data
    branch_data = parse_branch_data(branch_data_text)
    
    # Generate the dashboard
    generate_dashboard_html(branch_data)
